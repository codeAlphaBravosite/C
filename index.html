<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CUET Examination Syllabus Tracker</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background-color: #f9fafb; /* Slightly off-white bg */
        }
        .section-title {
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .section-title:hover {
            background-color: rgba(0, 0, 0, 0.05); /* Subtle hover on title */
        }
        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, padding 0.5s ease-out; /* Smoother transition */
            padding: 0 1rem; /* Start with no vertical padding */
        }
        .section-content.active {
            max-height: 10000px; /* Ensure enough height */
            padding: 1rem 1rem; /* Add padding when active */
        }
        .progress-bar {
            height: 8px;
            transition: width 0.4s ease;
        }
        .topic {
            border-left: 4px solid transparent; /* Slightly thicker border */
            transition: all 0.2s ease;
            padding: 0.75rem 0.5rem; /* Increased padding */
            margin-top: 0.5rem;
            background-color: #fff; /* Give topics white background */
            border-radius: 4px; /* Rounded corners for topics */
            box-shadow: 0 1px 2px rgba(0,0,0,0.05); /* Subtle shadow */
        }
        .topic:hover {
            background-color: #f9fafb; /* Use body bg for hover */
            border-left-color: #d1d5db; /* Gray border on hover */
        }
        .topic.highlighted {
            border-left-color: #FCD34D; /* Tailwind amber-300 */
            background-color: #FFFBEB; /* Lighter yellow bg for highlighted */
        }
        .topic.completed {
            /* Keep default text color, line-through is enough indicator */
            opacity: 0.8; /* Slightly fade completed */
        }
        .topic.completed .topic-label {
             text-decoration: line-through;
             color: #6b7280; /* Keep gray color for label only */
        }
        .topic.completed.highlighted {
             /* Styles already applied from .completed and .highlighted */
             opacity: 0.8;
        }

        .subtopic-list { /* Changed from div.subtopic */
            margin-left: 0.5rem; /* Slightly reduced indent */
            margin-top: 0.5rem;
            list-style: disc;
            padding-left: 1.5rem; /* Use padding for list marker */
            color: #4b5563; /* Slightly darker gray for subtopics */
        }
        .subtopic-item { /* Changed from div.topic-item */
             padding: 0.1rem 0; /* Adjust vertical spacing */
        }

        /* Improved Checkbox */
        .custom-checkbox {
            appearance: none;
            -webkit-appearance: none;
            width: 20px; /* Slightly larger */
            height: 20px;
            border: 2px solid #cbd5e0; /* Tailwind gray-300 */
            border-radius: 4px;
            margin-right: 10px; /* More space */
            position: relative;
            top: 5px; /* Adjust alignment */
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            flex-shrink: 0; /* Prevent shrinking in flex layout */
        }
        .custom-checkbox:checked {
            background-color: #4f46e5; /* Indigo-600 */
            border-color: #4f46e5;
        }
        .custom-checkbox:checked::after {
            content: 'âœ“';
            position: absolute;
            color: white;
            font-size: 14px; /* Slightly larger check */
            font-weight: bold;
            top: -1px;
            left: 3px;
        }
        .custom-checkbox:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.5); /* Focus ring */
        }

        /* Improved Highlight Button */
        .highlight-btn {
            opacity: 0.6; /* Start slightly more visible */
            transition: opacity 0.2s ease, color 0.2s ease;
            padding: 0.25rem; /* Add padding for larger tap area */
            border-radius: 50%;
            color: #f59e0b; /* Amber-500 */
        }
        .highlight-btn:hover {
            opacity: 1;
            background-color: rgba(245, 158, 11, 0.1); /* Light amber background on hover */
        }
        .highlight-btn.active {
            opacity: 1;
            color: #d97706; /* Amber-600 for active */
        }
         .highlight-btn .fa-star {
             display: block; /* Ensure icon takes up space for padding */
         }
        .highlight-btn:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.5); /* Focus ring */
        }


        /* Search Highlight */
        .search-highlight {
            background-color: #FEF3C7; /* Tailwind amber-100 */
            border-radius: 2px;
            box-shadow: 0 0 0 1px #FCD34D; /* Subtle border for search highlight */
        }

        /* Ensure focus visibility for accessibility */
        .section-title:focus, #expand-all:focus, #collapse-all:focus, #reset-progress:focus, #search-input:focus {
             outline: none;
             box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.5); /* Consistent focus ring */
        }
         #search-input:focus {
            border-color: #4f46e5; /* Match focus ring */
         }


        /* Mobile adjustments */
        @media (max-width: 640px) {
            .sticky-header-content {
                flex-direction: column;
                align-items: stretch; /* Stretch items full width */
            }
            .progress-container {
                margin-bottom: 0.75rem; /* Add space below progress */
                width: 100%;
            }
            .controls-container {
                margin-bottom: 0.75rem; /* Add space below controls */
                justify-content: space-around; /* Space out buttons */
                width: 100%;
            }
            .search-container {
                width: 100%;
            }
            h1 {
                font-size: 1.5rem; /* Smaller title on mobile */
            }
            .section-title h2 {
                 font-size: 1.125rem; /* text-lg */
            }
            .section-title .flex.items-center > div.ml-4 { /* Section progress container */
                display: none; /* Hide section progress on small screens to save space */
            }
        }

        @media print {
            .no-print {
                display: none;
            }
            body {
                background-color: #fff;
            }
            .section-content {
                max-height: none !important;
                overflow: visible !important;
                padding: 1rem 0 !important; /* Adjust print padding */
            }
            .topic {
                box-shadow: none;
                border: 1px solid #eee;
                margin-top: 0.5rem;
            }
            .sticky /* Remove stickiness for print */ {
                position: static;
            }
        }
    </style>
</head>
<body class="bg-gray-100"> <!-- Changed body bg -->
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Sticky Header -->
        <div class="sticky top-0 z-20 bg-white rounded-lg shadow-lg p-4 md:p-6 mb-6 no-print">
             <!-- Header Content Wrapper -->
            <div class="flex flex-wrap justify-between items-center mb-4 sticky-header-content">
                 <!-- Progress Section -->
                <div class="flex items-center w-full md:w-auto progress-container">
                    <span class="text-gray-700 mr-2 text-sm md:text-base whitespace-nowrap">Overall Progress:</span>
                    <div class="w-full md:w-48 h-2 bg-gray-200 rounded-full mr-2">
                        <div id="overall-progress" class="progress-bar bg-green-500 rounded-full" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <span id="progress-percentage" class="ml-auto md:ml-2 text-sm font-semibold text-gray-600">0%</span>
                </div>

                <!-- Controls Section -->
                <div class="flex space-x-2 controls-container">
                    <button id="expand-all" class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 text-sm transition-colors duration-200">Expand All</button>
                    <button id="collapse-all" class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 text-sm transition-colors duration-200">Collapse All</button>
                    <button id="reset-progress" class="px-3 py-1 bg-red-100 text-red-700 rounded-md hover:bg-red-200 text-sm transition-colors duration-200">Reset</button> <!-- Shorter Text -->
                </div>
            </div>

             <!-- Title and Search Section -->
             <div class="text-center mb-4">
                 <h1 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-1">CUET Syllabus Tracker</h1>
                 <p class="text-gray-600 text-sm md:text-base">Mark topics completed and highlight key areas.</p>
             </div>

             <div class="relative search-container">
                <input type="text" id="search-input" placeholder="Search topics..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                    <i class="fas fa-search"></i>
                </span>
            </div>
        </div>

        <div id="syllabus-content">
            <!-- I. General Knowledge -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                <button class="section-title bg-blue-600 text-white p-4 w-full flex justify-between items-center focus:outline-none" data-section="general-knowledge" aria-expanded="false" aria-controls="content-general-knowledge">
                    <div class="flex items-center">
                        <h2 class="text-xl font-semibold">I. General Knowledge</h2>
                        <div class="ml-4 hidden md:flex items-center"> <!-- Hide progress on mobile -->
                            <div class="w-32 h-2 bg-blue-300 rounded-full">
                                <div class="section-progress progress-bar bg-white rounded-full" style="width: 0%"></div>
                            </div>
                            <span class="ml-2 text-sm section-percentage">0%</span>
                        </div>
                    </div>
                    <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                </button>
                <div id="content-general-knowledge" class="section-content" role="region">
                    <!-- Indian History -->
                    <div class="mb-4">
                        <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-2 border-b pb-1 border-blue-100">Indian History</h3>
                        
                        <div class="topic p-2 rounded">
                             <div class="flex justify-between items-center">
                                <div class="flex items-start"> <!-- Align items start for checkbox -->
                                    <input type="checkbox" class="custom-checkbox topic-checkbox" id="ancient-india" aria-labelledby="label-ancient-india">
                                    <label id="label-ancient-india" for="ancient-india" class="font-semibold topic-label cursor-pointer">Ancient India (3000 BC - 1200 AD)</label>
                                </div>
                                <button class="highlight-btn text-yellow-500 focus:outline-none flex-shrink-0 ml-2" title="Highlight topic" aria-label="Highlight Ancient India">
                                    <i class="fas fa-star"></i>
                                </button>
                            </div>
                             <ul class="subtopic-list"> <!-- Use UL for subtopics -->
                                <li class="subtopic-item">â€¢ Indus Valley Civilization: Urban planning, trade, and decline.</li>
                                <li class="subtopic-item">â€¢ Vedic Age: Society, religion, and literature.</li>
                                <li class="subtopic-item">â€¢ Mauryan Empire: Administration, Ashoka's edicts, and economy.</li>
                                <li class="subtopic-item">â€¢ Gupta Empire: Golden Age, art, and science.</li>
                            </ul>
                        </div>
                        
                        <div class="topic p-2 rounded mt-2">
                            <div class="flex justify-between items-center">
                                <div class="flex items-start">
                                    <input type="checkbox" class="custom-checkbox topic-checkbox" id="medieval-india" aria-labelledby="label-medieval-india">
                                    <label id="label-medieval-india" for="medieval-india" class="font-semibold topic-label cursor-pointer">Medieval India (1200 - 1707 AD)</label>
                                </div>
                                <button class="highlight-btn text-yellow-500 focus:outline-none flex-shrink-0 ml-2" title="Highlight topic" aria-label="Highlight Medieval India">
                                    <i class="fas fa-star"></i>
                                </button>
                            </div>
                             <ul class="subtopic-list">
                                <li class="subtopic-item">â€¢ Delhi Sultanate: Dynasties, architecture, and administration.</li>
                                <li class="subtopic-item">â€¢ Mughal Empire: Akbar's policies, Taj Mahal, and decline.</li>
                                <li class="subtopic-item">â€¢ Rajputs: Kingdoms, culture, and resistance.</li>
                            </ul>
                        </div>
                        
                        <div class="topic p-2 rounded mt-2">
                            <div class="flex justify-between items-center">
                                <div class="flex items-start">
                                    <input type="checkbox" class="custom-checkbox topic-checkbox" id="modern-india" aria-labelledby="label-modern-india">
                                    <label id="label-modern-india" for="modern-india" class="font-semibold topic-label cursor-pointer">Modern India (1707 AD - Present)</label>
                                </div>
                                <button class="highlight-btn text-yellow-500 focus:outline-none flex-shrink-0 ml-2" title="Highlight topic" aria-label="Highlight Modern India">
                                    <i class="fas fa-star"></i>
                                </button>
                            </div>
                            <ul class="subtopic-list">
                                <li class="subtopic-item">â€¢ British Rule: East India Company, colonial policies, and revolts.</li>
                                <li class="subtopic-item">â€¢ Independence Movement: Non-cooperation, Quit India, and leaders.</li>
                                <li class="subtopic-item">â€¢ Post-Independence: Constitution, integration, and economic policies.</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Geography (Apply similar structure: h3, topic divs with flex, ul.subtopic-list > li.subtopic-item) -->
                    <div class="mb-4">
                        <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Geography</h3>
                        <div class="topic p-2 rounded">
                            <div class="flex justify-between items-center">
                               <div class="flex items-start">
                                    <input type="checkbox" class="custom-checkbox topic-checkbox" id="physical-geography" aria-labelledby="label-physical-geography">
                                    <label id="label-physical-geography" for="physical-geography" class="font-semibold topic-label cursor-pointer">Physical Geography</label>
                                </div>
                                <button class="highlight-btn text-yellow-500 focus:outline-none flex-shrink-0 ml-2" title="Highlight topic" aria-label="Highlight Physical Geography">
                                    <i class="fas fa-star"></i>
                                </button>
                            </div>
                            <ul class="subtopic-list">
                                <li class="subtopic-item">â€¢ Mountains: Himalayas, Western Ghats, and their significance.</li>
                                <li class="subtopic-item">â€¢ Rivers: Ganges, Brahmaputra, and river systems.</li>
                                <li class="subtopic-item">â€¢ Lakes: Dal Lake, Chilika Lake, and their ecological importance.</li>
                                <li class="subtopic-item">â€¢ Deserts: Thar Desert, features, and climate.</li>
                                <li class="subtopic-item">â€¢ Climate: Monsoon, seasons, and climate zones.</li>
                                <li class="subtopic-item">â€¢ Natural Resources: Minerals, forests, and water resources.</li>
                            </ul>
                        </div>
                        <div class="topic p-2 rounded mt-2">
                           <div class="flex justify-between items-center">
                                <div class="flex items-start">
                                    <input type="checkbox" class="custom-checkbox topic-checkbox" id="economic-geography" aria-labelledby="label-economic-geography">
                                    <label id="label-economic-geography" for="economic-geography" class="font-semibold topic-label cursor-pointer">Economic Geography</label>
                                </div>
                                <button class="highlight-btn text-yellow-500 focus:outline-none flex-shrink-0 ml-2" title="Highlight topic" aria-label="Highlight Economic Geography">
                                    <i class="fas fa-star"></i>
                                </button>
                            </div>
                            <ul class="subtopic-list">
                                <li class="subtopic-item">â€¢ Agriculture: Crops, green revolution, and irrigation.</li>
                                <li class="subtopic-item">â€¢ Industry: Major industries, industrial policies, and growth.</li>
                                <li class="subtopic-item">â€¢ Trade: Domestic and international trade, exports, and imports.</li>
                                <li class="subtopic-item">â€¢ Transportation: Railways, roads, and ports.</li>
                            </ul>
                        </div>
                         <div class="topic p-2 rounded mt-2">
                           <div class="flex justify-between items-center">
                               <div class="flex items-start">
                                    <input type="checkbox" class="custom-checkbox topic-checkbox" id="political-geography" aria-labelledby="label-political-geography">
                                    <label id="label-political-geography" for="political-geography" class="font-semibold topic-label cursor-pointer">Political Geography</label>
                                </div>
                                <button class="highlight-btn text-yellow-500 focus:outline-none flex-shrink-0 ml-2" title="Highlight topic" aria-label="Highlight Political Geography">
                                    <i class="fas fa-star"></i>
                                </button>
                            </div>
                             <ul class="subtopic-list">
                                <li class="subtopic-item">â€¢ States and Union Territories: List, capitals, and boundaries.</li>
                                <li class="subtopic-item">â€¢ Capitals: National and state capitals, historical significance.</li>
                                <li class="subtopic-item">â€¢ International Boundaries: India-Pakistan, India-China, etc.</li>
                             </ul>
                        </div>
                    </div>

                    <!-- Economy (Apply similar structure) -->
                    <div class="mb-4">
                        <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Economy</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                         </div>

                    <!-- Polity (Apply similar structure) -->
                     <div class="mb-4">
                        <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Polity</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>

                     <!-- Culture (Apply similar structure) -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Culture</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>

                     <!-- Sports (Apply similar structure) -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Sports</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>

                     <!-- Awards and Honours (Apply similar structure) -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Awards and Honours</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>

                     <!-- Important Days (Apply similar structure) -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Important Days</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>

                     <!-- Books and Authors (Apply similar structure) -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Books and Authors</h3>
                          <!-- ... topics and subtopics using the new structure ... -->
                     </div>

                     <!-- Science and Technology (Apply similar structure) -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-blue-800 mb-3 mt-4 border-b pb-1 border-blue-100">Science and Technology</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>
                 </div>
             </div>

            <!-- II. Current Affairs (Repeat the structure improvement for this section and all subsequent sections) -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                 <button class="section-title bg-green-600 text-white p-4 w-full flex justify-between items-center focus:outline-none" data-section="current-affairs" aria-expanded="false" aria-controls="content-current-affairs">
                    <div class="flex items-center">
                        <h2 class="text-xl font-semibold">II. Current Affairs</h2>
                         <div class="ml-4 hidden md:flex items-center">
                            <div class="w-32 h-2 bg-green-300 rounded-full">
                                <div class="section-progress progress-bar bg-white rounded-full" style="width: 0%"></div>
                            </div>
                            <span class="ml-2 text-sm section-percentage">0%</span>
                        </div>
                    </div>
                     <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                 </button>
                 <div id="content-current-affairs" class="section-content" role="region">
                      <!-- National News -->
                     <div class="mb-4">
                         <h3 class="font-semibold text-lg text-green-800 mb-3 mt-2 border-b pb-1 border-green-100">National News</h3>
                         <!-- ... topics and subtopics using the new structure ... -->
                     </div>
                      <!-- International News -->
                     <div class="mb-4">
                          <h3 class="font-semibold text-lg text-green-800 mb-3 mt-4 border-b pb-1 border-green-100">International News</h3>
                          <!-- ... topics and subtopics using the new structure ... -->
                     </div>
                     <!-- ... other subsections for Current Affairs ... -->
                 </div>
             </div>

             <!-- III. General Mental Ability (Apply structure) -->
             <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                 <button class="section-title bg-purple-600 text-white p-4 w-full flex justify-between items-center focus:outline-none" data-section="general-mental-ability" aria-expanded="false" aria-controls="content-general-mental-ability">
                     <!-- ... title content ... -->
                      <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                 </button>
                 <div id="content-general-mental-ability" class="section-content" role="region">
                      <h3 class="font-semibold text-lg text-purple-800 mb-3 mt-2 border-b pb-1 border-purple-100">Logical Reasoning</h3>
                     <!-- ... topics ... -->
                       <h3 class="font-semibold text-lg text-purple-800 mb-3 mt-4 border-b pb-1 border-purple-100">Analytical Reasoning</h3>
                     <!-- ... topics ... -->
                      <!-- ... other subsections ... -->
                 </div>
             </div>

            <!-- IV. Numerical Ability (Apply structure) -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                 <button class="section-title bg-red-600 text-white p-4 w-full flex justify-between items-center focus:outline-none" data-section="numerical-ability" aria-expanded="false" aria-controls="content-numerical-ability">
                     <!-- ... title content ... -->
                      <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                 </button>
                 <div id="content-numerical-ability" class="section-content" role="region">
                      <h3 class="font-semibold text-lg text-red-800 mb-3 mt-2 border-b pb-1 border-red-100">Number System</h3>
                     <!-- ... topics ... -->
                     <!-- ... other subsections ... -->
                 </div>
             </div>

             <!-- V. Quantitative Reasoning (Apply structure) -->
             <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                 <button class="section-title bg-yellow-600 text-white p-4 w-full flex justify-between items-center focus:outline-none" data-section="quantitative-reasoning" aria-expanded="false" aria-controls="content-quantitative-reasoning">
                      <!-- ... title content ... -->
                      <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                 </button>
                 <div id="content-quantitative-reasoning" class="section-content" role="region">
                      <h3 class="font-semibold text-lg text-yellow-800 mb-3 mt-2 border-b pb-1 border-yellow-100">Data Interpretation</h3>
                     <!-- ... topics ... -->
                      <!-- ... other subsections ... -->
                 </div>
             </div>

             <!-- VI. English (Apply structure) -->
             <div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
                 <button class="section-title bg-indigo-600 text-white p-4 w-full flex justify-between items-center focus:outline-none" data-section="english" aria-expanded="false" aria-controls="content-english">
                     <!-- ... title content ... -->
                     <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                 </button>
                 <div id="content-english" class="section-content" role="region">
                      <h3 class="font-semibold text-lg text-indigo-800 mb-3 mt-2 border-b pb-1 border-indigo-100">Reading Comprehension</h3>
                     <!-- ... topics ... -->
                     <!-- ... other subsections ... -->
                 </div>
             </div>
            <!-- NOTE: You will need to manually replace the content structure (topic divs, subtopic divs) -->
            <!-- within ALL sections (II through VI) following the pattern shown in Section I -->
            <!-- This involves: -->
            <!-- 1. Changing subtopic container div to ul.subtopic-list -->
            <!-- 2. Changing subtopic item div to li.subtopic-item -->
            <!-- 3. Adding appropriate aria-labels to highlight buttons -->
            <!-- 4. Adding aria-labelledby to checkboxes and corresponding id to labels -->
            <!-- 5. Updating the <h3> styles and structure -->
            <!-- 6. Making section titles <button> elements for better A11y -->

        </div> <!-- End #syllabus-content -->
    </div> <!-- End .container -->

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize local storage
            const completedTopics = JSON.parse(localStorage.getItem('completedTopics')) || {};
            const highlightedTopics = JSON.parse(localStorage.getItem('highlightedTopics')) || {};

            // Elements
            const sectionTitles = document.querySelectorAll('.section-title');
            const topicCheckboxes = document.querySelectorAll('.topic-checkbox');
            const highlightButtons = document.querySelectorAll('.highlight-btn');
            const expandAllBtn = document.getElementById('expand-all');
            const collapseAllBtn = document.getElementById('collapse-all');
            const resetProgressBtn = document.getElementById('reset-progress');
            const searchInput = document.getElementById('search-input');
            const allTopics = document.querySelectorAll('.topic'); // Get all topic containers

            // Toggle section content
            sectionTitles.forEach(title => {
                const content = document.getElementById(title.getAttribute('aria-controls'));
                if (!content) return; // Safety check

                // Initial ARIA state based on whether content starts active
                 const isActive = content.classList.contains('active');
                 title.setAttribute('aria-expanded', isActive ? 'true' : 'false');


                title.addEventListener('click', function() {
                    const currentlyExpanded = this.getAttribute('aria-expanded') === 'true';
                    content.classList.toggle('active');
                    this.setAttribute('aria-expanded', !currentlyExpanded);
                    this.querySelector('i.fa-chevron-down').classList.toggle('rotate-180');
                    // Note: Progress updates only when checkboxes change now, not on expand/collapse
                });
            });

             // Helper to find the containing topic element
            function findTopicElement(element) {
                let current = element;
                while (current && !current.classList.contains('topic')) {
                    current = current.parentElement;
                 }
                 return current;
             }

            // Mark topic as completed
            topicCheckboxes.forEach(checkbox => {
                const topicElement = findTopicElement(checkbox);
                if (!topicElement) return;

                 // Load saved state
                if (completedTopics[checkbox.id]) {
                    checkbox.checked = true;
                    topicElement.classList.add('completed');
                }

                checkbox.addEventListener('change', function() {
                    const topic = findTopicElement(this); // Re-find topic on change
                    if (!topic) return;

                    if (this.checked) {
                        topic.classList.add('completed');
                        completedTopics[this.id] = true;
                    } else {
                        topic.classList.remove('completed');
                        delete completedTopics[this.id];
                    }

                    localStorage.setItem('completedTopics', JSON.stringify(completedTopics));
                    updateProgress(); // Update progress on change
                });
            });

            // Highlight topics to remember
            highlightButtons.forEach(button => {
                const topicElement = findTopicElement(button);
                 if (!topicElement) return;
                const checkbox = topicElement.querySelector('.topic-checkbox');
                 if (!checkbox) return;
                 const topicId = checkbox.id;

                // Load saved state
                if (highlightedTopics[topicId]) {
                    button.classList.add('active');
                    topicElement.classList.add('highlighted');
                }

                button.addEventListener('click', function(event) {
                    event.stopPropagation(); // Prevent click bubbling to section title if nested differently
                    const topic = findTopicElement(this); // Re-find topic on click
                     if (!topic) return;
                     const cb = topic.querySelector('.topic-checkbox');
                     if (!cb) return;
                     const currentTopicId = cb.id;

                    this.classList.toggle('active');
                    topic.classList.toggle('highlighted');

                    if (topic.classList.contains('highlighted')) {
                        highlightedTopics[currentTopicId] = true;
                    } else {
                        delete highlightedTopics[currentTopicId];
                    }

                    localStorage.setItem('highlightedTopics', JSON.stringify(highlightedTopics));
                });
            });

            // Expand/Collapse all sections
            expandAllBtn.addEventListener('click', function() {
                sectionTitles.forEach(title => {
                     const content = document.getElementById(title.getAttribute('aria-controls'));
                     if(content) {
                         content.classList.add('active');
                         title.setAttribute('aria-expanded', 'true');
                         title.querySelector('i.fa-chevron-down').classList.add('rotate-180');
                     }
                 });
            });

            collapseAllBtn.addEventListener('click', function() {
                 sectionTitles.forEach(title => {
                    const content = document.getElementById(title.getAttribute('aria-controls'));
                    if(content) {
                         content.classList.remove('active');
                         title.setAttribute('aria-expanded', 'false');
                         title.querySelector('i.fa-chevron-down').classList.remove('rotate-180');
                     }
                 });
            });

            // Reset progress
            resetProgressBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to reset all progress and highlights? This cannot be undone.')) {
                    localStorage.removeItem('completedTopics');
                    localStorage.removeItem('highlightedTopics');

                    topicCheckboxes.forEach(checkbox => {
                        checkbox.checked = false;
                        const topic = findTopicElement(checkbox);
                         if (topic) topic.classList.remove('completed');
                    });

                    highlightButtons.forEach(button => {
                         button.classList.remove('active');
                        const topic = findTopicElement(button);
                         if (topic) topic.classList.remove('highlighted');
                    });

                    updateProgress();
                    // Optionally collapse all sections after reset
                    // collapseAllBtn.click();
                }
            });

            // --- Search Functionality ---
            let searchHighlights = []; // Store highlighted elements for easy removal

            function clearSearchHighlights() {
                searchHighlights.forEach(({ element, originalHTML }) => {
                    element.innerHTML = originalHTML; // Restore original content
                });
                searchHighlights = [];
                 // Ensure all topics are visible after clearing search
                 allTopics.forEach(topic => {
                    topic.style.display = ''; // Reset display
                 });
                 // Also make sure subsection containers are visible if they were hidden
                 document.querySelectorAll('.mb-4').forEach(subSection => {
                    subSection.style.display = '';
                });
            }

            function performSearch(term) {
                clearSearchHighlights();
                if (term.length < 2) {
                    return; // Only search for terms >= 2 chars
                }

                const regex = new RegExp(`(${term.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi'); // Case-insensitive, global
                 let firstMatchElement = null;
                 let matchesFound = false;

                 allTopics.forEach(topic => {
                    const topicContentElement = topic; // Search within the whole topic div
                     const originalHTML = topicContentElement.innerHTML;
                     let textContent = topicContentElement.textContent || topicContentElement.innerText || "";
                     let topicHasMatch = false;

                     if (textContent.toLowerCase().includes(term)) {
                         topicHasMatch = true;
                         matchesFound = true;

                         // Highlight matches within the topic (carefully, avoid breaking HTML)
                        // This simple text replace is prone to breaking HTML structure if tags contain the search term.
                        // A more robust solution involves traversing text nodes.
                        // For simplicity here, we'll just show/hide the topic.
                        // Highlighting will be done via CSS class on subtopic items if needed.

                         // Add highlight class to matching subtopic items
                         topic.querySelectorAll('.subtopic-item').forEach(item => {
                             if (item.textContent.toLowerCase().includes(term)) {
                                 // Basic highlight approach: wrap text content
                                 // More robust: traverse text nodes and wrap matches
                                 const itemOriginalHTML = item.innerHTML;
                                 const newHTML = item.innerHTML.replace(regex, '<span class="search-highlight">$1</span>');
                                 if (newHTML !== itemOriginalHTML) {
                                     item.innerHTML = newHTML;
                                     // Store original state for cleanup
                                     searchHighlights.push({ element: item, originalHTML: itemOriginalHTML });
                                 }
                             }
                         });
                         // Also check the main label
                         const label = topic.querySelector('.topic-label');
                         if (label && label.textContent.toLowerCase().includes(term)) {
                            const labelOriginalHTML = label.innerHTML;
                            const newHTML = label.innerHTML.replace(regex, '<span class="search-highlight">$1</span>');
                             if (newHTML !== labelOriginalHTML) {
                                label.innerHTML = newHTML;
                                searchHighlights.push({ element: label, originalHTML: labelOriginalHTML });
                             }
                         }


                         if (!firstMatchElement) {
                             firstMatchElement = topic;
                         }
                    }

                    topic.style.display = topicHasMatch ? '' : 'none'; // Show/hide topic

                     // Also hide/show the parent subsection title if it contains no visible topics
                     const subsection = topic.closest('.mb-4'); // Find parent like "Indian History" container
                     if (subsection) {
                         const visibleTopicsInSection = subsection.querySelectorAll('.topic[style*="display: block"], .topic:not([style])'); // Topics not explicitly hidden
                         subsection.style.display = visibleTopicsInSection.length > 0 ? '' : 'none';
                     }

                     // Ensure the parent section accordion is open if a match is found inside
                     if (topicHasMatch) {
                         const sectionContent = topic.closest('.section-content');
                         if (sectionContent && !sectionContent.classList.contains('active')) {
                             const sectionTitle = document.querySelector(`.section-title[aria-controls="${sectionContent.id}"]`);
                             if (sectionTitle) {
                                 sectionTitle.click(); // Open the section
                             }
                         }
                     }
                });

                 // Scroll to the first match if found
                 if (firstMatchElement) {
                     // Use scrollIntoView with smooth behavior
                     firstMatchElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                 }
            }

            // Debounce search input
            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                const searchTerm = this.value.toLowerCase().trim();
                searchTimeout = setTimeout(() => {
                    performSearch(searchTerm);
                }, 300); // Wait 300ms after user stops typing
            });


            // Calculate and update progress
            function updateProgress() {
                const totalTopics = topicCheckboxes.length;
                if (totalTopics === 0) return; // Avoid division by zero

                 let totalCompletedCount = 0;
                 topicCheckboxes.forEach(checkbox => {
                    if(checkbox.checked) {
                         totalCompletedCount++;
                     }
                 });

                 const overallPercentage = Math.round((totalCompletedCount / totalTopics) * 100);

                 const overallProgressBar = document.getElementById('overall-progress');
                 const progressPercentageSpan = document.getElementById('progress-percentage');

                 if(overallProgressBar) {
                     overallProgressBar.style.width = `${overallPercentage}%`;
                     overallProgressBar.setAttribute('aria-valuenow', overallPercentage);
                 }
                 if(progressPercentageSpan) {
                     progressPercentageSpan.textContent = `${overallPercentage}%`;
                 }

                 // Section progress (ensure elements exist)
                 document.querySelectorAll('.section-title').forEach(sectionTitle => {
                    const sectionContent = document.getElementById(sectionTitle.getAttribute('aria-controls'));
                    if (!sectionContent) return;

                     const sectionCheckboxes = sectionContent.querySelectorAll('.topic-checkbox');
                    const sectionTotal = sectionCheckboxes.length;
                    if (sectionTotal === 0) return;

                     let sectionCompleted = 0;
                     sectionCheckboxes.forEach(checkbox => {
                        if (checkbox.checked) {
                            sectionCompleted++;
                        }
                    });

                    const sectionPercentage = Math.round((sectionCompleted / sectionTotal) * 100);
                    const sectionProgressBar = sectionTitle.querySelector('.section-progress');
                    const sectionPercentageSpan = sectionTitle.querySelector('.section-percentage');

                    if (sectionProgressBar) {
                         sectionProgressBar.style.width = `${sectionPercentage}%`;
                    }
                     if(sectionPercentageSpan) {
                         sectionPercentageSpan.textContent = `${sectionPercentage}%`;
                     }
                });
            }

            // --- Initial Setup ---
            updateProgress();

             // Open first section by default (if it exists and isn't already open)
             const firstSectionTitle = document.querySelector('.section-title');
             if (firstSectionTitle && firstSectionTitle.getAttribute('aria-expanded') === 'false') {
                // Don't auto-click if search might be active on load
                if (!searchInput.value) {
                    firstSectionTitle.click();
                }
             }

            // Re-apply highlights and completed states on search clear/update
            // (This is implicitly handled by performSearch clearing and re-evaluating,
            // and by the initial load applying styles correctly)

        }); // End DOMContentLoaded
    </script>
</body>
</html>
